(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{499:function(t,a,s){"use strict";s.r(a);var n=s(42),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"页面的生命周期"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#页面的生命周期"}},[t._v("#")]),t._v(" 页面的生命周期")]),t._v(" "),s("p",[t._v("页面的生命周期主要常用的事件有这几个")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("DOMCotentLoaded， 发生在 document，对象上，可以通过 addEventListener 监听")])]),t._v(" "),s("li",[s("p",[t._v("load， 发生在 window 对象上，可以通过 window.onload 监听到。")])]),t._v(" "),s("li",[s("p",[t._v("unload， 发生在 window 对象上，可以通过 window.onunload 监听到。")])]),t._v(" "),s("li",[s("p",[t._v("breforeload， 发生在 window 上，可以通过 window.onbeforeload 监听到。")])])]),t._v(" "),s("p",[t._v("下面来一一介绍他们。")]),t._v(" "),s("h2",{attrs:{id:"domcotentloaded"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#domcotentloaded"}},[t._v("#")]),t._v(" DOMCotentLoaded")]),t._v(" "),s("p",[t._v("该事件主要是  dom 树准备就绪时触发，也就是 dom 已近构建好了，但是像图片，外部样式表可能还没有加载。")]),t._v(" "),s("p",[t._v("这时候是可以拿到 dom 的，但是，比如想拿到 图片的宽高，此时是拿不到的，因为它不会等这些资源的加载。")]),t._v(" "),s("div",{staticClass:"language-html line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}},[s("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ready")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DOM is ready'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 图片目前尚未加载完成（除非已经被缓存），所以图片的大小为 0x0")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("Image size: ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("img"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offsetWidth"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("x")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("img"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offsetHeight"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  document"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"DOMContentLoaded"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ready"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("img")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("img"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https://en.js.cx/clipart/train.gif?speed=1&cache=0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br")])]),s("hr"),t._v(" "),s("p",[t._v("如上述代码所示，此时 alert 的是 0， 因为虽然可以拿到 img ，但是图片还没有加载好。")]),t._v(" "),s("p",[t._v("在回到我们的 html 文件的解析过程，ui 渲染线程和 js 线程是不能同时进行的。")]),t._v(" "),s("p",[t._v("也就是说，该事件的监听函数会在所有的 script 脚本执行完毕再执行。")]),t._v(" "),s("p",[t._v("但是，也有例外，比如，")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("如果脚本加上了 async。那么就表示其资源是要等 dom 构建完毕再加载。所以，它标识的脚本是在 DOMCotentLoaded 之后执行的。")])]),t._v(" "),s("li",[s("p",[t._v("对于动态生成的脚本，比如 document.createElement('script'), 它也不会阻塞 dom 的构建。")])])]),t._v(" "),s("hr"),t._v(" "),s("p",[s("strong",[t._v("应用")])]),t._v(" "),s("p",[t._v("很多浏览器，在登陆界面的时候，如果之前记住密码，它会自动填充密码，这就是在 DOMCotentLoaded 上做的。")]),t._v(" "),s("p",[t._v("如果 dom 构建的比较慢的话，我们会看到，用户名和密码一开始是空白，一会自动填上了，这就是 DOMCotentLoaded 延迟的结果。")]),t._v(" "),s("p",[t._v("最后，总结一下。")]),t._v(" "),s("p",[t._v("DOMContentLoaded 事件是在 dom 构建好时触发， 但像图片一些资源并没有加载完毕。")]),t._v(" "),s("p",[t._v("要监听该事件得， document.addEvenetListener('DOMCotentLoaded',() => {})")]),t._v(" "),s("h2",{attrs:{id:"load"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#load"}},[t._v("#")]),t._v(" load")]),t._v(" "),s("p",[t._v("load 是发生在 window 上的。")]),t._v(" "),s("p",[t._v("想比较 DOMCotentLoaded 而言，此时所有资源都拿到了。")]),t._v(" "),s("p",[t._v("监听的话，使用 window.onload(() => {})")]),t._v(" "),s("div",{staticClass:"language-html line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}},[s("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n  window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onload")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 与此相同 window.addEventListener('load', (event) => {")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Page loaded'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 此时图片已经加载完成")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("alert")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token template-string"}},[s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("Image size: ")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("img"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offsetWidth"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("x")]),s("span",{pre:!0,attrs:{class:"token interpolation"}},[s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("img"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("offsetHeight"),s("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("img")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("img"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https://en.js.cx/clipart/train.gif?speed=1&cache=0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br")])]),s("p",[t._v("相比较之前，这次我们是可以拿到 图片宽高的。")]),t._v(" "),s("h2",{attrs:{id:"breforeunload"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#breforeunload"}},[t._v("#")]),t._v(" breforeunload")]),t._v(" "),s("p",[t._v("该事件也是 window 上的事件， 可以通过 window.onbeforeload 监听到。")]),t._v(" "),s("p",[t._v("该事件主要是在，用户离开当前页面前触发，比如用户点击了关闭页面的按钮,或者用户刷新当前页面。 触发")]),t._v(" "),s("p",[t._v("该事件发生时，document 文档还是可见的，也就是页面还是可以看见的，并且此时该事件也可以取消。")]),t._v(" "),s("p",[t._v("该事件会让浏览器弹出一个对话框，问用户是否要离开当前页面，如果用户确认，浏览器将导航到新页面，否则导航将会取消。")]),t._v(" "),s("p",[t._v("之前玩赛尔号的时候，关闭的时候，就会经常触发这样一个弹框，应该也是用了 beforeunluad 事件。")]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("深究好像还有些复杂，就先到这里吧。。。。")]),t._v(" "),s("h2",{attrs:{id:"unload"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#unload"}},[t._v("#")]),t._v(" unload")]),t._v(" "),s("p",[t._v("unload 事件也是 window 对象上的事件，它发生在 beforeunload 之后，可以通过 window.onunload 监听到")]),t._v(" "),s("p",[t._v("当用户离开当前页面时，会触发该事件。")]),t._v(" "),s("p",[t._v("此时可以收集一些，用户的信息，发送给服务器，比如，访问了哪些页面。")]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("在看 mdn 时，上面说应当当避免使用 该事件。")]),t._v(" "),s("p",[t._v("特别是在移动端上，因为该事件触发不那么可靠。")])])}),[],!1,null,null,null);a.default=e.exports}}]);