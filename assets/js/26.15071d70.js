(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{423:function(v,_,t){v.exports=t.p+"assets/img/cdn1.4b98bba3.jpg"},424:function(v,_,t){v.exports=t.p+"assets/img/cdn2.b273566d.jpg"},596:function(v,_,t){"use strict";t.r(_);var i=t(42),p=Object(i.a)({},(function(){var v=this,_=v.$createElement,i=v._self._c||_;return i("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[i("h1",{attrs:{id:"cdn-原理"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#cdn-原理"}},[v._v("#")]),v._v(" CDN 原理")]),v._v(" "),i("p",[v._v("CDN :Content Distribution Network, 即内容分发网络。")]),v._v(" "),i("p",[v._v("目的是，把服务器的资源分发给多个服务器。好处有")]),v._v(" "),i("ol",[i("li",[i("p",[v._v("缓解源服务器的工作量。")])]),v._v(" "),i("li",[i("p",[v._v("如果请求放距离源服务器很远的话，可能要延迟很久，选择就近的 cdn 服务器可以加快请求。")])]),v._v(" "),i("li",[i("p",[v._v("缓解甚至消除了不同运营商之间互联的瓶颈造成的影响")])])]),v._v(" "),i("p",[v._v("来看图吧：")]),v._v(" "),i("p",[i("img",{attrs:{src:t(423),alt:""}})]),v._v(" "),i("h2",{attrs:{id:"cdn-工作原理"}},[i("a",{staticClass:"header-anchor",attrs:{href:"#cdn-工作原理"}},[v._v("#")]),v._v(" CDN 工作原理")]),v._v(" "),i("p",[v._v("复习之前，建议过一遍 CDN 原理，")]),v._v(" "),i("p",[v._v("我们把源服务器的资源分发给各个 CDN服务器，又不想影响用户，最简单的办法，就是在 DNS 解析的时候重定向。")]),v._v(" "),i("p",[v._v("先看图：")]),v._v(" "),i("p",[i("img",{attrs:{src:t(424),alt:""}})]),v._v(" "),i("ul",[i("li",[i("p",[v._v("GSLB: 全局负载均衡系统。")])]),v._v(" "),i("li",[i("p",[v._v("SLB：本地负载均衡系统。")])]),v._v(" "),i("li",[i("p",[v._v("缓存服务器：即我们源服务器分发的 CDN 服务器了。")])])]),v._v(" "),i("p",[v._v("我们以请求 join.qq.com/hello.html 为例子。")]),v._v(" "),i("ol",[i("li",[i("p",[v._v("DNS 客户端从浏览器那拿到主机名，发给本地DNS服务器。")])]),v._v(" "),i("li",[i("p",[v._v("本地服务器将其发送给根服务器(没有缓存的话)，根服务器返回顶级域名服务器 .com 的 ip。")])]),v._v(" "),i("li",[i("p",[v._v("本地 DNS 服务器拿到后，请求.com ，返回权威服务器 qq.com 的  ip。")])]),v._v(" "),i("li",[i("p",[v._v("拿到该 ip 后请求 权威服务器，权威服务器开始查找。")]),v._v(" "),i("ul",[i("li",[v._v("找到一条 CNAME 记录，name = join.qq.com, value = join.qq.cdn.com ;")]),v._v(" "),i("li",[v._v("还找到一条 A 记录，name = join.qq.cdn.com, value = GSLB 的 ip 地址。")])])]),v._v(" "),i("li",[i("p",[v._v("本地DNS 向 GLSB 发送 DNS 查询报文")])]),v._v(" "),i("li",[i("p",[v._v("GLSB 根据本地DNS 判断用户大概来自深圳，筛选出华南地区综合考量最优的 SLB 的 ip 返回 。")])]),v._v(" "),i("li",[i("p",[v._v("本地DNS 将上一步的 ip 作为最终 查询结果返回给 CDN客户端，再给浏览器。")])]),v._v(" "),i("li",[i("p",[v._v("浏览器访问 SLB, SLB 筛选出最佳的 CDN 服务器，后回应客户端的 HTTP 请求，(z状态码为 302，重定向至该最佳 CDN 服务器)")])]),v._v(" "),i("li",[i("p",[v._v("该 CDN 服务器判断资源是否存在，是否过期，再把资源直接个诶客户端，否则就去源站更新内容。")])])]),v._v(" "),i("p",[v._v("参考：https://juejin.cn/post/6844903873518239752")])])}),[],!1,null,null,null);_.default=p.exports}}]);