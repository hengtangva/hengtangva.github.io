(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{418:function(v,a,A){v.exports=A.p+"assets/img/dnssimple.ad381620.jpg"},419:function(v,a){v.exports="data:image/jpeg;base64,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"},420:function(v,a,A){v.exports=A.p+"assets/img/dns2.ce2e8017.jpg"},421:function(v,a,A){v.exports=A.p+"assets/img/redns.1ac2bd3c.jpg"},422:function(v,a,A){v.exports=A.p+"assets/img/dnsmessage.104423da.jpg"},595:function(v,a,A){"use strict";A.r(a);var p=A(42),t=Object(p.a)({},(function(){var v=this,a=v.$createElement,p=v._self._c||a;return p("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[p("h1",{attrs:{id:"dns-的原理"}},[p("a",{staticClass:"header-anchor",attrs:{href:"#dns-的原理"}},[v._v("#")]),v._v(" DNS 的原理")]),v._v(" "),p("h2",{attrs:{id:"前言"}},[p("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[v._v("#")]),v._v(" 前言")]),v._v(" "),p("p",[v._v("DNS 主要功能就是 提供 主机名 转 IP 服务的。")]),v._v(" "),p("p",[v._v("他是一个协议，在应用层，运行在 UDP 之上，使用 53 号端口。")]),v._v(" "),p("p",[v._v("它也是一个由分层 DNS 服务器实现的分布式数据库。")]),v._v(" "),p("hr"),v._v(" "),p("p",[v._v("了解了 DNS 是什么，我么再来看它的工作原理。")]),v._v(" "),p("h2",{attrs:{id:"dns-工作原理"}},[p("a",{staticClass:"header-anchor",attrs:{href:"#dns-工作原理"}},[v._v("#")]),v._v(" DNS 工作原理")]),v._v(" "),p("p",[v._v("先来看一个最简单的例子。")]),v._v(" "),p("p",[v._v("当我们在浏览器中输入一个 url 之后会发生什么呢？")]),v._v(" "),p("ul",[p("li",[p("p",[v._v("同一台用户主机上运行着 DNS 应用的客户端。")])]),v._v(" "),p("li",[p("p",[v._v("浏览器将上述 url 中抽取出 主机名，并将主机名，传给 DNS 应用客户端。")])]),v._v(" "),p("li",[p("p",[v._v("DNS 客户端向 DNS 服务器发送一个包含主机名的请求。")])]),v._v(" "),p("li",[p("p",[v._v("DNS 服务器返回一个包含 IP 地址的报文给 DNS 客户端，并转交给浏览器。")])]),v._v(" "),p("li",[p("p",[v._v("流浪器拿到 ip 后，立即向该 ip 地址的 80 端口的 HTTP 服务器发起 TCP 连接。")])])]),v._v(" "),p("p",[p("img",{attrs:{src:A(418),alt:""}})]),v._v(" "),p("hr"),v._v(" "),p("p",[v._v("对用户来说，DNS 就像一个黑盒子，主机名进去，ip 出来。接下来我们来打开这个黑盒子，看看它到底干了什么。")]),v._v(" "),p("h3",{attrs:{id:"dns-服务器类型"}},[p("a",{staticClass:"header-anchor",attrs:{href:"#dns-服务器类型"}},[v._v("#")]),v._v(" DNS 服务器类型")]),v._v(" "),p("p",[v._v("DNS 应用程序在我们客户端，主要就是把浏览器转交的 主机名 发送出去，得到 ip 再转交给 浏览器。这里不多谈。")]),v._v(" "),p("p",[v._v("我们更关注的是 DNS 的服务器。")]),v._v(" "),p("p",[v._v("下面是 DNS 服务器的种类。")]),v._v(" "),p("ol",[p("li",[p("p",[v._v("根 DNS 服务器：")]),v._v(" "),p("ul",[p("li",[p("p",[v._v("有 400 多个 根 DNS 服务器遍及全世界，它们由十三个不同组织管理。")])]),v._v(" "),p("li",[p("p",[v._v("根 DNS 服务器 主要提供 TLD(顶级域名)服务器的地址。")])])])]),v._v(" "),p("li",[p("p",[v._v("TLD(top-level domain) DNS 服务器：")]),v._v(" "),p("ul",[p("li",[p("p",[v._v("对于每一个顶级域(如 .com  .org   .edu) 和所有国家的顶级域(如：.ca  .jp  .fr) 都有 TLD 服务器.")])]),v._v(" "),p("li",[p("p",[v._v("TLD 服务器提供了权威服务器的 ip 地址。")])])])]),v._v(" "),p("li",[p("p",[v._v("权威 DNS 服务器：")]),v._v(" "),p("ul",[p("li",[p("p",[v._v("在因特网上具有公共可访问主机(如 web 服务器)的每个组织必须提供公共可访问的 DNS 记录。这些记录将 主机名 映射成 ip 地址。而，一些组织的权威服务器收藏了这些 DNS 记录。")])]),v._v(" "),p("li",[p("p",[v._v("当然也可以支付费用，把这些记录存在服务器提供商的 权威服务器中")])])])]),v._v(" "),p("li",[p("p",[v._v("本地 DNS 服务：")]),v._v(" "),p("ul",[p("li",[p("p",[v._v("主机的本地 DNS 服务器通常邻近本主机。")])]),v._v(" "),p("li",[p("p",[v._v("对某机构 ISP 而言，本地 DNS 服务器可能就和主机在一个局域网中。")])]),v._v(" "),p("li",[p("p",[v._v("对某居民区而言，本地 DNS 服务器通常与主机相隔不超过几台服务器。")])])])])]),v._v(" "),p("hr"),v._v(" "),p("p",[v._v("严格来说，本地 DNS 服务器并不属于 DNS 服务器的层次结构，其层次结构如下：")]),v._v(" "),p("p",[p("img",{attrs:{src:A(419),alt:""}})]),v._v(" "),p("h3",{attrs:{id:"dns-工作流程"}},[p("a",{staticClass:"header-anchor",attrs:{href:"#dns-工作流程"}},[v._v("#")]),v._v(" DNS 工作流程")]),v._v(" "),p("p",[v._v("先来看图，我们按照图片来分析")]),v._v(" "),p("p",[p("img",{attrs:{src:A(420),alt:""}})]),v._v(" "),p("ol",[p("li",[p("p",[v._v("假设主机想知道 www.163.com 的 ip")])]),v._v(" "),p("li",[p("p",[v._v("首先向本地 DNS 服务器发送报文。")])]),v._v(" "),p("li",[p("p",[v._v("本地DNS服务器转发到根服务器，根服务器返回对应顶级域服务器 ip 地址，这里是 .com")])]),v._v(" "),p("li",[p("p",[v._v("于是，本地DNS服务器拿到这个 ip 后，就向 .com DNS服务器发送报文。顶级域服务器返回对应的权威服务器的 ip")])]),v._v(" "),p("li",[p("p",[v._v("本地服务器又拿到该 ip 去请求 权威DNS服务器 163.com，它里面存在对应的 ip 地址，将其返回。")])]),v._v(" "),p("li",[p("p",[v._v("于是本地 DNS 服务拿到想要的 ip 就转发给 DNS 客户端，再转给浏览器。")])])]),v._v(" "),p("hr"),v._v(" "),p("p",[v._v("我们顺便来了解一下两种查询方式，迭代查询，递归查询")]),v._v(" "),p("p",[p("strong",[v._v("递归查询")]),p("br"),v._v("\n图中 step1 和 step2 是递归查询"),p("br"),v._v("\n递归查询很像深度遍历。")]),v._v(" "),p("p",[p("strong",[v._v("迭代查询")]),p("br"),v._v("\n图中 step2 step4 step6 是迭代查询"),p("br"),v._v("\n迭代查询很像广度遍历。")]),v._v(" "),p("p",[v._v("当然也可以全部都用递归查询，如下图：")]),v._v(" "),p("p",[p("img",{attrs:{src:A(421),alt:""}})]),v._v(" "),p("p",[v._v("不过，通常查询不会采取这种模式，一般是我们分析的那种查询方式。"),p("br"),v._v("\n即，请求主机到本地DNS 是递归的，其余都是迭代的。")]),v._v(" "),p("h3",{attrs:{id:"dns-缓存"}},[p("a",{staticClass:"header-anchor",attrs:{href:"#dns-缓存"}},[v._v("#")]),v._v(" DNS 缓存")]),v._v(" "),p("p",[v._v("实际上，不可能所有的 DNS 查询都要走这么多弯，因为我们没个服务器都是有缓存的。")]),v._v(" "),p("p",[v._v("当第一次访问后，就会有缓存。比如我们访问过一次 www.163.com 后，本地服务器下次就可以直接在自己缓存中找到其对应 ip 了，不用费更多功夫。")]),v._v(" "),p("p",[v._v("通常，DNS 服务器缓存时间是 2 天，两天过后自动抛弃。")]),v._v(" "),p("p",[v._v("而且，有了缓存的存在，几乎没有查询会经过 根DNS服务器 了。")]),v._v(" "),p("h2",{attrs:{id:"dns-报文与记录"}},[p("a",{staticClass:"header-anchor",attrs:{href:"#dns-报文与记录"}},[v._v("#")]),v._v(" DNS 报文与记录")]),v._v(" "),p("p",[v._v("DNS 中的记录中储存了 资源记录到 ip 的映射，且每个回答报文中都会包含一条或多条记录。")]),v._v(" "),p("h3",{attrs:{id:"dns-记录"}},[p("a",{staticClass:"header-anchor",attrs:{href:"#dns-记录"}},[v._v("#")]),v._v(" DNS 记录")]),v._v(" "),p("p",[v._v("DNS 记录是包含下列字段的四元组。")]),v._v(" "),p("p",[p("strong",[v._v("(name, value, type, ttl)")])]),v._v(" "),p("ul",[p("li",[p("p",[v._v("TTL 是该记录的生存时间，规定多少时间后，自动删除该条记录。")])]),v._v(" "),p("li",[p("p",[v._v("name 和 type 值取决于 type")])]),v._v(" "),p("li",[p("p",[v._v("我们重点来看 type。")]),v._v(" "),p("ol",[p("li",[p("p",[v._v("Type = A, address，表明 name 是主机名，value 是主机对应的 ip")])]),v._v(" "),p("li",[p("p",[v._v("Type = CNAME, canonical name, 表明 value 是别名为 name 的主机对应的规范主机名，也就是说，访问 name 其实就是访问 value，那你就反问 value 去吧。例子可以看 cdn 原理。如："),p("br"),v._v("\n(foo.com, relay1.bar.foo.com, CNAME,145.37.45.34)")])]),v._v(" "),p("li",[p("p",[v._v("Type = NS, 则 name 是个域，而 value 是如何获得该域中主机 ip 地址 的权威DNS服务器的主机名，这个记录用于查询链来路由DNS查询。")])]),v._v(" "),p("li",[p("p",[v._v("Type = MX, 表明 value 是别名为 name 的邮件服务器规范主机名，这里仅做了解。")])])])])]),v._v(" "),p("h3",{attrs:{id:"报文"}},[p("a",{staticClass:"header-anchor",attrs:{href:"#报文"}},[v._v("#")]),v._v(" 报文")]),v._v(" "),p("p",[v._v("报文暂时搁置在这，因为没碰到过，给幅图，仅做了解。")]),v._v(" "),p("p",[p("img",{attrs:{src:A(422),alt:""}})])])}),[],!1,null,null,null);a.default=t.exports}}]);