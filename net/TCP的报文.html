<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>TCP 的报文 | Valjeanth&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/logo.jpg">
    <meta name="description" content="我亦飘零久，十年来，深恩负尽">
    
    <link rel="preload" href="/assets/css/0.styles.60dd0459.css" as="style"><link rel="preload" href="/assets/js/app.0ca42ae6.js" as="script"><link rel="preload" href="/assets/js/2.515f669a.js" as="script"><link rel="preload" href="/assets/js/45.7d9bf1e6.js" as="script"><link rel="prefetch" href="/assets/js/10.4260b3ca.js"><link rel="prefetch" href="/assets/js/100.6421f402.js"><link rel="prefetch" href="/assets/js/101.753d4f5a.js"><link rel="prefetch" href="/assets/js/102.04d0f91c.js"><link rel="prefetch" href="/assets/js/103.fce5b587.js"><link rel="prefetch" href="/assets/js/104.0c1d91c6.js"><link rel="prefetch" href="/assets/js/105.6fc090b0.js"><link rel="prefetch" href="/assets/js/106.eb04df43.js"><link rel="prefetch" href="/assets/js/107.1ed6d9d7.js"><link rel="prefetch" href="/assets/js/108.49134f48.js"><link rel="prefetch" href="/assets/js/109.46747f86.js"><link rel="prefetch" href="/assets/js/11.88b87b82.js"><link rel="prefetch" href="/assets/js/110.741b0788.js"><link rel="prefetch" href="/assets/js/111.8ad168c8.js"><link rel="prefetch" href="/assets/js/112.1dd92670.js"><link rel="prefetch" href="/assets/js/113.36b21cde.js"><link rel="prefetch" href="/assets/js/114.8c3be7f7.js"><link rel="prefetch" href="/assets/js/115.aa32a5a3.js"><link rel="prefetch" href="/assets/js/116.c623be61.js"><link rel="prefetch" href="/assets/js/117.f301d9c7.js"><link rel="prefetch" href="/assets/js/118.58eb2a6e.js"><link rel="prefetch" href="/assets/js/119.84201e70.js"><link rel="prefetch" href="/assets/js/12.ba2c56b3.js"><link rel="prefetch" href="/assets/js/120.d4f914fb.js"><link rel="prefetch" href="/assets/js/121.11bc675f.js"><link rel="prefetch" href="/assets/js/122.532b2aa0.js"><link rel="prefetch" href="/assets/js/123.8f7cab97.js"><link rel="prefetch" href="/assets/js/124.dc742648.js"><link rel="prefetch" href="/assets/js/125.6a76c691.js"><link rel="prefetch" href="/assets/js/126.ba2f5e66.js"><link rel="prefetch" href="/assets/js/127.6e07b924.js"><link rel="prefetch" href="/assets/js/128.82fc423e.js"><link rel="prefetch" href="/assets/js/129.d9481933.js"><link rel="prefetch" href="/assets/js/13.976410ef.js"><link rel="prefetch" href="/assets/js/130.ee749818.js"><link rel="prefetch" href="/assets/js/131.b4dd6ab8.js"><link rel="prefetch" href="/assets/js/132.11d6a700.js"><link rel="prefetch" href="/assets/js/133.ef42d156.js"><link rel="prefetch" href="/assets/js/134.d21933e8.js"><link rel="prefetch" href="/assets/js/135.e324a67b.js"><link rel="prefetch" href="/assets/js/136.ae22e3fd.js"><link rel="prefetch" href="/assets/js/137.44125a63.js"><link rel="prefetch" href="/assets/js/138.90654653.js"><link rel="prefetch" href="/assets/js/139.0ebaf63b.js"><link rel="prefetch" href="/assets/js/14.e80a197e.js"><link rel="prefetch" href="/assets/js/140.2079d708.js"><link rel="prefetch" href="/assets/js/141.8e4d75b9.js"><link rel="prefetch" href="/assets/js/142.83530f40.js"><link rel="prefetch" href="/assets/js/143.7c173663.js"><link rel="prefetch" href="/assets/js/144.2f3f7052.js"><link rel="prefetch" href="/assets/js/145.cfd7fd4d.js"><link rel="prefetch" href="/assets/js/146.beded037.js"><link rel="prefetch" href="/assets/js/147.bb629f5d.js"><link rel="prefetch" href="/assets/js/148.f9eaf4a6.js"><link rel="prefetch" href="/assets/js/149.c32d056f.js"><link rel="prefetch" href="/assets/js/15.29d46668.js"><link rel="prefetch" href="/assets/js/150.9e8fd1d5.js"><link rel="prefetch" href="/assets/js/151.7ddadbf1.js"><link rel="prefetch" href="/assets/js/152.4cdea0b2.js"><link rel="prefetch" href="/assets/js/153.20ed70a0.js"><link rel="prefetch" href="/assets/js/154.da8fb617.js"><link rel="prefetch" href="/assets/js/155.6434a5e4.js"><link rel="prefetch" href="/assets/js/156.48d7ae00.js"><link rel="prefetch" href="/assets/js/157.bdef5aef.js"><link rel="prefetch" href="/assets/js/158.ea38b600.js"><link rel="prefetch" href="/assets/js/159.62a5224a.js"><link rel="prefetch" href="/assets/js/16.cd6ae33a.js"><link rel="prefetch" href="/assets/js/160.8c5ad686.js"><link rel="prefetch" href="/assets/js/161.97be7ce4.js"><link rel="prefetch" href="/assets/js/162.fbf93ae3.js"><link rel="prefetch" href="/assets/js/163.918582a9.js"><link rel="prefetch" href="/assets/js/164.72f6a0bc.js"><link rel="prefetch" href="/assets/js/165.f827ebab.js"><link rel="prefetch" href="/assets/js/166.15d06ffe.js"><link rel="prefetch" href="/assets/js/167.7df80607.js"><link rel="prefetch" href="/assets/js/168.863f80be.js"><link rel="prefetch" href="/assets/js/169.ab705a84.js"><link rel="prefetch" href="/assets/js/17.ef754595.js"><link rel="prefetch" href="/assets/js/170.12e580e7.js"><link rel="prefetch" href="/assets/js/171.11a30b2a.js"><link rel="prefetch" href="/assets/js/172.9807ea7e.js"><link rel="prefetch" href="/assets/js/173.84c6c833.js"><link rel="prefetch" href="/assets/js/174.fdcf6905.js"><link rel="prefetch" href="/assets/js/175.18d4a0fd.js"><link rel="prefetch" href="/assets/js/176.2f11ad7e.js"><link rel="prefetch" href="/assets/js/177.349808b6.js"><link rel="prefetch" href="/assets/js/178.92f16f7d.js"><link rel="prefetch" href="/assets/js/18.748745ae.js"><link rel="prefetch" href="/assets/js/19.0dc2491a.js"><link rel="prefetch" href="/assets/js/20.58a81011.js"><link rel="prefetch" href="/assets/js/21.6791ffce.js"><link rel="prefetch" href="/assets/js/22.b7737885.js"><link rel="prefetch" href="/assets/js/23.13c52e18.js"><link rel="prefetch" href="/assets/js/24.b5cc4189.js"><link rel="prefetch" href="/assets/js/25.5179744c.js"><link rel="prefetch" href="/assets/js/26.15071d70.js"><link rel="prefetch" href="/assets/js/27.5dc790d0.js"><link rel="prefetch" href="/assets/js/28.f661e5a0.js"><link rel="prefetch" href="/assets/js/29.ccd17902.js"><link rel="prefetch" href="/assets/js/3.03c42818.js"><link rel="prefetch" href="/assets/js/30.133e4b80.js"><link rel="prefetch" href="/assets/js/31.97ad996e.js"><link rel="prefetch" href="/assets/js/32.aa847bf2.js"><link rel="prefetch" href="/assets/js/33.caff8a6f.js"><link rel="prefetch" href="/assets/js/34.c39015f6.js"><link rel="prefetch" href="/assets/js/35.99dce353.js"><link rel="prefetch" href="/assets/js/36.25276d0a.js"><link rel="prefetch" href="/assets/js/37.3ee0cf49.js"><link rel="prefetch" href="/assets/js/38.5312a451.js"><link rel="prefetch" href="/assets/js/39.cb875e0c.js"><link rel="prefetch" href="/assets/js/4.55b24f61.js"><link rel="prefetch" href="/assets/js/40.7bb1ce63.js"><link rel="prefetch" href="/assets/js/41.1476e2aa.js"><link rel="prefetch" href="/assets/js/42.94ec0921.js"><link rel="prefetch" href="/assets/js/43.57464c8f.js"><link rel="prefetch" href="/assets/js/44.49edbd69.js"><link rel="prefetch" href="/assets/js/46.82129287.js"><link rel="prefetch" href="/assets/js/47.c81e8da4.js"><link rel="prefetch" href="/assets/js/48.97bc83ad.js"><link rel="prefetch" href="/assets/js/49.d8bbad3b.js"><link rel="prefetch" href="/assets/js/5.2d78771d.js"><link rel="prefetch" href="/assets/js/50.f29dd3d7.js"><link rel="prefetch" href="/assets/js/51.6d4d9750.js"><link rel="prefetch" href="/assets/js/52.b738267c.js"><link rel="prefetch" href="/assets/js/53.07789ac4.js"><link rel="prefetch" href="/assets/js/54.88b3b39c.js"><link rel="prefetch" href="/assets/js/55.4b5a5bd1.js"><link rel="prefetch" href="/assets/js/56.19136ce9.js"><link rel="prefetch" href="/assets/js/57.b2d4e97d.js"><link rel="prefetch" href="/assets/js/58.a71287e5.js"><link rel="prefetch" href="/assets/js/59.5d05a341.js"><link rel="prefetch" href="/assets/js/6.a2648412.js"><link rel="prefetch" href="/assets/js/60.36566b7b.js"><link rel="prefetch" href="/assets/js/61.7fb8bd5e.js"><link rel="prefetch" href="/assets/js/62.79c495ea.js"><link rel="prefetch" href="/assets/js/63.818f4818.js"><link rel="prefetch" href="/assets/js/64.2e1edce8.js"><link rel="prefetch" href="/assets/js/65.ff262b83.js"><link rel="prefetch" href="/assets/js/66.60acc120.js"><link rel="prefetch" href="/assets/js/67.deb435db.js"><link rel="prefetch" href="/assets/js/68.eb6c7329.js"><link rel="prefetch" href="/assets/js/69.7d811fcb.js"><link rel="prefetch" href="/assets/js/7.fd97ac92.js"><link rel="prefetch" href="/assets/js/70.c35e94a7.js"><link rel="prefetch" href="/assets/js/71.1de0d635.js"><link rel="prefetch" href="/assets/js/72.5a76251b.js"><link rel="prefetch" href="/assets/js/73.6ddc25d9.js"><link rel="prefetch" href="/assets/js/74.8b6a24a3.js"><link rel="prefetch" href="/assets/js/75.729ca7db.js"><link rel="prefetch" href="/assets/js/76.e7124283.js"><link rel="prefetch" href="/assets/js/77.6864f29c.js"><link rel="prefetch" href="/assets/js/78.2465a4d6.js"><link rel="prefetch" href="/assets/js/79.56801182.js"><link rel="prefetch" href="/assets/js/8.2b28110d.js"><link rel="prefetch" href="/assets/js/80.b1714fa0.js"><link rel="prefetch" href="/assets/js/81.d20c21da.js"><link rel="prefetch" href="/assets/js/82.de9be220.js"><link rel="prefetch" href="/assets/js/83.53811558.js"><link rel="prefetch" href="/assets/js/84.ac8c69ec.js"><link rel="prefetch" href="/assets/js/85.3c2e589a.js"><link rel="prefetch" href="/assets/js/86.27d25c85.js"><link rel="prefetch" href="/assets/js/87.b1a6cc13.js"><link rel="prefetch" href="/assets/js/88.58582737.js"><link rel="prefetch" href="/assets/js/89.efc33e31.js"><link rel="prefetch" href="/assets/js/9.ea793fe0.js"><link rel="prefetch" href="/assets/js/90.75a19669.js"><link rel="prefetch" href="/assets/js/91.22469024.js"><link rel="prefetch" href="/assets/js/92.7e49cbb7.js"><link rel="prefetch" href="/assets/js/93.fe94d538.js"><link rel="prefetch" href="/assets/js/94.45248260.js"><link rel="prefetch" href="/assets/js/95.7fb3b93f.js"><link rel="prefetch" href="/assets/js/96.11147273.js"><link rel="prefetch" href="/assets/js/97.49775c49.js"><link rel="prefetch" href="/assets/js/98.8f9ef363.js"><link rel="prefetch" href="/assets/js/99.01b8e783.js">
    <link rel="stylesheet" href="/assets/css/0.styles.60dd0459.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="assets/logo.jpg" alt="Valjeanth's blog" class="logo"> <span class="site-name can-hide">Valjeanth's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/net/" class="nav-link router-link-active">
  网络方面
</a></div><div class="nav-item"><a href="/advance/" class="nav-link">
  前端进阶
</a></div><div class="nav-item"><a href="/life/" class="nav-link">
  lifeRain
</a></div><div class="nav-item"><a href="/vue/" class="nav-link">
  vue 知识
</a></div><div class="nav-item"><a href="/react/" class="nav-link">
  react 知识
</a></div><div class="nav-item"><a href="/computerBase/" class="nav-link">
  碰到的问题
</a></div><div class="nav-item"><a href="/css/" class="nav-link">
  css基础
</a></div><div class="nav-item"><a href="/accumulate/" class="nav-link">
  js基础
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  算法基础
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/net/" class="nav-link router-link-active">
  网络方面
</a></div><div class="nav-item"><a href="/advance/" class="nav-link">
  前端进阶
</a></div><div class="nav-item"><a href="/life/" class="nav-link">
  lifeRain
</a></div><div class="nav-item"><a href="/vue/" class="nav-link">
  vue 知识
</a></div><div class="nav-item"><a href="/react/" class="nav-link">
  react 知识
</a></div><div class="nav-item"><a href="/computerBase/" class="nav-link">
  碰到的问题
</a></div><div class="nav-item"><a href="/css/" class="nav-link">
  css基础
</a></div><div class="nav-item"><a href="/accumulate/" class="nav-link">
  js基础
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  算法基础
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">Home</a></li><li><a href="/net/TCP简介.html" class="sidebar-link">TCP 简介</a></li><li><a href="/net/TCP的报文.html" class="active sidebar-link">TCP 的报文</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/net/TCP的报文.html#前言" class="sidebar-link">前言</a></li><li class="sidebar-sub-header"><a href="/net/TCP的报文.html#tcp-首部" class="sidebar-link">TCP 首部</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/net/TCP的报文.html#源端口号和目的端口号" class="sidebar-link">源端口号和目的端口号</a></li><li class="sidebar-sub-header"><a href="/net/TCP的报文.html#序列号和确认号" class="sidebar-link">序列号和确认号</a></li><li class="sidebar-sub-header"><a href="/net/TCP的报文.html#接收窗口" class="sidebar-link">接收窗口</a></li><li class="sidebar-sub-header"><a href="/net/TCP的报文.html#标志字段" class="sidebar-link">标志字段</a></li><li class="sidebar-sub-header"><a href="/net/TCP的报文.html#校检和-和-紧急数据指针" class="sidebar-link">校检和 和 紧急数据指针</a></li><li class="sidebar-sub-header"><a href="/net/TCP的报文.html#首部长度-和-保留未用" class="sidebar-link">首部长度 和 保留未用</a></li></ul></li><li class="sidebar-sub-header"><a href="/net/TCP的报文.html#选项" class="sidebar-link">选项</a></li><li class="sidebar-sub-header"><a href="/net/TCP的报文.html#数据" class="sidebar-link">数据</a></li></ul></li><li><a href="/net/TCP的连接管理.html" class="sidebar-link">TCP 的连接管理</a></li><li><a href="/net/TCP的窗口滑动.html" class="sidebar-link">/net/TCP的窗口滑动.html</a></li><li><a href="/net/TCP的超时时间.html" class="sidebar-link">TCP 的超时时间</a></li><li><a href="/net/TCP的拥塞机制.html" class="sidebar-link">/net/TCP的拥塞机制.html</a></li><li><a href="/net/http状态码.html" class="sidebar-link">http 的转态码</a></li><li><a href="/net/http首部.html" class="sidebar-link">http 的首部</a></li><li><a href="/net/http的get和post的区别.html" class="sidebar-link">get 和 post 区别</a></li><li><a href="/net/http和https.html" class="sidebar-link">http 和 https</a></li><li><a href="/net/http的版本.html" class="sidebar-link">htpp 1.0/1.1/2.0/3.0</a></li><li><a href="/net/CDN原理.html" class="sidebar-link">CDN 原理</a></li><li><a href="/net/DNS原理.html" class="sidebar-link">DNS 的原理</a></li><li><a href="/net/cookie的作用.html" class="sidebar-link">cookie 的作用</a></li><li><a href="/net/SSL加密.html" class="sidebar-link">SSL 加密</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="tcp-的报文"><a href="#tcp-的报文" class="header-anchor">#</a> TCP 的报文</h1> <h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>这里详细介绍一下 tcp 的报文结构。</p> <p>主要是了解 tcp 首部各个字段的作用。</p> <p>首先， 一个 TCP 包的大小受到 最大报文段限制(MSS)</p> <p>MSS 通常根据最初确定的由本地发送主机发送的 最大链路层帧长度 即最大传输单元(MTU) 来设置</p> <p>通俗来说，就是一个 tcp 包不会被下层协议给切成两份传递。</p> <p>也就是说 tcp首部 + 数据 &lt;= MSS</p> <p>其报文结构如下：</p> <p><img src="/assets/img/tcphead.2f87bd2e.jpg" alt=""></p> <h2 id="tcp-首部"><a href="#tcp-首部" class="header-anchor">#</a> TCP 首部</h2> <p>首部一般 20 个字节。</p> <h3 id="源端口号和目的端口号"><a href="#源端口号和目的端口号" class="header-anchor">#</a> 源端口号和目的端口号</h3> <p>这个两个分部占 2 个字节。</p> <p>源端口号是发生方发生的端口号， 目的端口号是接受方的端口号。</p> <p>它们是用来多路复用和多路分解的。 这里顺便提一下这两个概念</p> <ol><li><p>多路分解： 将运输层报文段中的数据交付到正确的套接字的工作，端口号就是各个套接字的标识。可惜想象一下，运输层发来很多数据，但你的不同应用要拿的数据包是不同的，比如 qq， 浏览器。这时候，就得把这些数据包根据各自的目的端口号进行分解。然后交给上层协议，或者说给对应的应用软件。</p></li> <li><p>多路复用： 多路复用就是和上面反这来的，所有的应用都得走传输层这一条路。那么就得有一个标识，表示你是哪来的。这个标识就是源端口号。</p></li></ol> <h3 id="序列号和确认号"><a href="#序列号和确认号" class="header-anchor">#</a> 序列号和确认号</h3> <p>序列号站了 4 个字节。 确认号占 4 个字节</p> <p>它们在 tcp 简介中说过了，主要是应答的时候保证数据的可靠传输。</p> <h3 id="接收窗口"><a href="#接收窗口" class="header-anchor">#</a> 接收窗口</h3> <p>接收窗口在 tcp 的流控制里也说过了。</p> <p>主要是接受方告诉发送方，自己缓冲区有多少空位，你下一次发送的窗口大小应该是多少。</p> <h3 id="标志字段"><a href="#标志字段" class="header-anchor">#</a> 标志字段</h3> <p>标志字段有 6 比特， 分别是 6 个标志</p> <ol><li><p>ACK : 用于指示确认字段的值是有效的，即该报文段包括一个对已被成功接受报文段的确认。规定连接后 ACK = 1</p></li> <li><p>SYN : 用于建立请求连接</p></li> <li><p>RST : 用于重新建立连接，即连接重置。</p></li> <li><p>FIN : 用于请求断开连接</p></li> <li><p>PSH : 该位置为 1 时，告诉接受方应立即将数据交给上层。不要等缓存慢了再加交付</p></li> <li><p>URG : 该位置为 1 时，表明报文中存在着被发送方上层实体设置为 紧急 的数据，该数据的最后一个字节由 2 字节的紧急数据指针指出。</p></li></ol> <h3 id="校检和-和-紧急数据指针"><a href="#校检和-和-紧急数据指针" class="header-anchor">#</a> 校检和 和 紧急数据指针</h3> <p>它们都是占 2 个字节。</p> <p>校检和主要是防止传输中数据出错，采用编码的方式对其进行校检。</p> <p>紧急数据指针指向报文中的紧急数据末尾字节。表明该数据应当立即交付。</p> <h3 id="首部长度-和-保留未用"><a href="#首部长度-和-保留未用" class="header-anchor">#</a> 首部长度 和 保留未用</h3> <p>首部长度占了 4 字节，由于 TCP 选项字段额原因， TCP 首部的长度是可变的。</p> <p>通常选项字段是为空的，所以一般 TCP 首部是 20 个字节。</p> <h2 id="选项"><a href="#选项" class="header-anchor">#</a> 选项</h2> <p>该部分主要用于</p> <ol><li><p>发送方和接收方协商最大报文段 MSS 。</p></li> <li><p>网络拥塞时，用作窗口的调节因子</p></li></ol> <h2 id="数据"><a href="#数据" class="header-anchor">#</a> 数据</h2> <p>里面放的是 应用层传来的 数据包</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/net/TCP简介.html" class="prev">
        TCP 简介
      </a></span> <span class="next"><a href="/net/TCP的连接管理.html">
        TCP 的连接管理
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.0ca42ae6.js" defer></script><script src="/assets/js/2.515f669a.js" defer></script><script src="/assets/js/45.7d9bf1e6.js" defer></script>
  </body>
</html>
